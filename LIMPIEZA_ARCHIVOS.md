# üßπ LIMPIEZA DE ARCHIVOS BASURA - SPACEFLIGHTS

## üéØ Objetivo
Eliminar archivos innecesarios, duplicados y temporales que no deber√≠an estar en el repositorio y que pueden generar confusi√≥n en los estudiantes.

---

## üö® ARCHIVOS BASURA IDENTIFICADOS

### 1Ô∏è‚É£ Notebooks Temporales (üî¥ CR√çTICO)
**Eliminar inmediatamente**:
```
notebooks/Untitled.ipynb
notebooks/Untitled1.ipynb
```

**Raz√≥n**: Notebooks sin nombre, probablemente de pruebas, no aportan valor educativo.

**Acci√≥n**:
```bash
rm -f notebooks/Untitled.ipynb notebooks/Untitled1.ipynb
```

---

### 2Ô∏è‚É£ Directorio airflow_dags/ DUPLICADO (üî¥ CR√çTICO)
**Problema**: Existe tanto `airflow_dags/` como `dags/` con los mismos archivos

**Directorios**:
```
airflow_dags/          # ‚ùå DUPLICADO
‚îú‚îÄ‚îÄ spaceflights_dag.py
‚îú‚îÄ‚îÄ spaceflights_data_processing_dag.py
‚îî‚îÄ‚îÄ spaceflights_reporting_dag.py

dags/                  # ‚úÖ CORRECTO (usado por Airflow)
‚îú‚îÄ‚îÄ spaceflights_dag.py
‚îú‚îÄ‚îÄ spaceflights_data_processing_dag.py
‚îî‚îÄ‚îÄ spaceflights_reporting_dag.py
```

**Raz√≥n**: Confusi√≥n sobre cu√°l es el directorio correcto. Airflow usa `dags/`.

**Acci√≥n**:
```bash
# Verificar que son id√©nticos
diff -r airflow_dags/ dags/

# Eliminar duplicado
rm -rf airflow_dags/
```

---

### 3Ô∏è‚É£ Build Artifacts (üî¥ CR√çTICO)
**Eliminar**:
```
build/                 # Artefactos de compilaci√≥n
dist/                  # Artefactos de distribuci√≥n
src/spaceflights.egg-info/  # Info de instalaci√≥n
```

**Raz√≥n**: 
- Generados autom√°ticamente por `pip install -e .`
- No deben estar en control de versiones
- Se regeneran en cada instalaci√≥n
- Ocupan espacio innecesario

**Acci√≥n**:
```bash
rm -rf build/ dist/ src/spaceflights.egg-info/
```

**Verificar en .gitignore**:
```gitignore
build/
dist/
*.egg-info/
```

---

### 4Ô∏è‚É£ Directorio backups/ (üü° REVISAR)
**Contenido**: Desconocido (no listado en scan)

**Raz√≥n posible eliminaci√≥n**:
- Backups no deben estar en repo
- Ocupan espacio
- Git ya es el sistema de control de versiones

**Acci√≥n**:
```bash
# Primero revisar contenido
ls -la backups/

# Si son realmente backups, eliminar
rm -rf backups/
```

**Alternativa**: Si son backups importantes, mover a ubicaci√≥n externa.

---

### 5Ô∏è‚É£ Logs de Airflow (üü° PARCIAL)
**Problema**: `logs/` contiene logs de ejecuciones de Airflow

**Contenido**:
```
logs/
‚îú‚îÄ‚îÄ dag_processor_manager/
‚îî‚îÄ‚îÄ scheduler/
    ‚îú‚îÄ‚îÄ 2025-10-03/
    ‚îú‚îÄ‚îÄ 2025-10-04/
    ‚îú‚îÄ‚îÄ 2025-10-05/
    ‚îú‚îÄ‚îÄ 2025-10-06/
    ‚îî‚îÄ‚îÄ 2025-10-07/
```

**Decisi√≥n**:
- ‚ùå NO eliminar el directorio logs/ (necesario para funcionamiento)
- ‚úÖ Limpiar logs antiguos
- ‚úÖ Mantener estructura
- ‚úÖ Verificar est√° en .gitignore

**Acci√≥n**:
```bash
# Limpiar contenido pero mantener estructura
find logs/ -type f -name "*.log" -delete
# O mantener logs y solo verificar .gitignore
```

**Verificar en .gitignore**:
```gitignore
logs/
*.log
```

---

### 6Ô∏è‚É£ Archivo info.log (üî¥ CR√çTICO)
**Eliminar**:
```
info.log               # Log en ra√≠z del proyecto
```

**Raz√≥n**: 
- Log individual que no deber√≠a estar commitado
- Informaci√≥n temporal de ejecuci√≥n
- Ya existe directorio logs/ para esto

**Acci√≥n**:
```bash
rm -f info.log
```

**Verificar en .gitignore**:
```gitignore
*.log
```

---

### 7Ô∏è‚É£ uv.lock (üü¢ OK - Ya en .gitignore)
**Estado**: Ya est√° en .gitignore seg√∫n README

**Verificaci√≥n necesaria**:
```bash
# Si est√° commitado, eliminarlo
git rm --cached uv.lock
```

**Acci√≥n**: Solo si est√° en git:
```bash
git rm --cached uv.lock
git commit -m "Remove uv.lock from version control"
```

---

### 8Ô∏è‚É£ docker-compose.override.yml (üü¢ OK - Ya en .gitignore)
**Estado**: Ya est√° en .gitignore

**Verificaci√≥n necesaria**:
```bash
# Si est√° commitado, eliminarlo
git rm --cached docker-compose.override.yml
```

---

### 9Ô∏è‚É£ __pycache__ Directories (üü° NORMAL)
**Ubicaciones**:
```
src/spaceflights/__pycache__/
dags/__pycache__/
tests/__pycache__/
... otros
```

**Estado**: 
- ‚úÖ Normal que existan en desarrollo
- ‚úÖ Ya est√°n en .gitignore
- ‚ùå No deben estar en git

**Acci√≥n**:
```bash
# Limpiar todos
find . -type d -name "__pycache__" -exec rm -rf {} + 2>/dev/null

# Verificar no est√°n en git
git rm -r --cached **/__pycache__/ 2>/dev/null || true
```

---

### üîü sessions/ Directory (üü¢ OK)
**Estado**: Directorio necesario para Kedro

**Acci√≥n**: 
- ‚úÖ Mantener directorio
- ‚úÖ Verificar est√° en .gitignore
- ‚ùå No commitear contenido

**Verificar en .gitignore**:
```gitignore
sessions/
```

---

### 1Ô∏è‚É£1Ô∏è‚É£ data/ con Datos Generados (üü° REVISAR)
**Problema**: `data/` contiene m√∫ltiples versiones de modelos y reportes

**Contenido problem√°tico**:
```
data/06_models/regressor.pickle/
‚îú‚îÄ‚îÄ 2025-08-20T23.24.39.892Z/
‚îú‚îÄ‚îÄ 2025-08-20T23.27.08.477Z/
‚îú‚îÄ‚îÄ 2025-10-02T22.24.02.478Z/
‚îú‚îÄ‚îÄ 2025-10-02T22.26.43.602Z/
‚îú‚îÄ‚îÄ 2025-10-02T22.28.31.006Z/
‚îú‚îÄ‚îÄ 2025-10-02T22.36.22.503Z/
‚îî‚îÄ‚îÄ 2025-10-02T22.36.54.243Z/    # 7 versiones!

data/08_reporting/
‚îú‚îÄ‚îÄ dummy_confusion_matrix.png/   # 6 versiones
‚îú‚îÄ‚îÄ shuttle_passenger_capacity_plot_exp.json/  # 6 versiones
‚îî‚îÄ‚îÄ shuttle_passenger_capacity_plot_go.json/   # 6 versiones
```

**Decisi√≥n**:
- ‚ùå No commitear estas versiones (ya est√°n en .gitignore)
- ‚úÖ Mantener solo 1-2 versiones m√°s recientes para ejemplo
- ‚úÖ Limpiar versiones antiguas

**Acci√≥n**:
```bash
# Script para mantener solo las 2 versiones m√°s recientes
./scripts/clean-old-versions.sh
```

---

### 1Ô∏è‚É£2Ô∏è‚É£ data/01_raw/ Parcialmente Vac√≠o (üü° ATENCI√ìN)
**Problema**: Solo tiene `shuttles.xlsx`, faltan otros archivos mencionados en catalog.yml

**catalog.yml menciona**:
- companies.csv ‚ùå FALTA
- reviews.csv ‚ùå FALTA
- shuttles.xlsx ‚úÖ EXISTE

**Acci√≥n**:
- Verificar si estos archivos deber√≠an existir
- Agregar archivos de ejemplo
- O actualizar catalog.yml y pipelines

---

## üìù SCRIPT DE LIMPIEZA AUTOMATIZADO

### Crear scripts/clean-repo.sh

```bash
#!/bin/bash
set -e

echo "üßπ Limpiando archivos basura del repositorio..."
echo ""

# Colores
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

# Contador de acciones
CLEANED=0

# 1. Notebooks temporales
echo -e "${YELLOW}1. Eliminando notebooks temporales...${NC}"
if rm -f notebooks/Untitled.ipynb notebooks/Untitled1.ipynb 2>/dev/null; then
    echo -e "${GREEN}‚úì Notebooks temporales eliminados${NC}"
    ((CLEANED++))
else
    echo -e "${GREEN}‚úì No hay notebooks temporales${NC}"
fi

# 2. Directorio airflow_dags duplicado
echo -e "${YELLOW}2. Verificando directorio airflow_dags duplicado...${NC}"
if [ -d "airflow_dags" ]; then
    echo "   Encontrado directorio duplicado. ¬øEliminar? (y/N)"
    read -r response
    if [[ "$response" =~ ^([yY][eE][sS]|[yY])$ ]]; then
        rm -rf airflow_dags/
        echo -e "${GREEN}‚úì airflow_dags/ eliminado${NC}"
        ((CLEANED++))
    fi
else
    echo -e "${GREEN}‚úì No existe directorio duplicado${NC}"
fi

# 3. Build artifacts
echo -e "${YELLOW}3. Eliminando build artifacts...${NC}"
rm -rf build/ dist/ src/spaceflights.egg-info/ 2>/dev/null
echo -e "${GREEN}‚úì Build artifacts eliminados${NC}"
((CLEANED++))

# 4. info.log
echo -e "${YELLOW}4. Eliminando info.log...${NC}"
if rm -f info.log 2>/dev/null; then
    echo -e "${GREEN}‚úì info.log eliminado${NC}"
    ((CLEANED++))
else
    echo -e "${GREEN}‚úì info.log no existe${NC}"
fi

# 5. __pycache__ directories
echo -e "${YELLOW}5. Limpiando __pycache__ directories...${NC}"
find . -type d -name "__pycache__" -exec rm -rf {} + 2>/dev/null || true
echo -e "${GREEN}‚úì __pycache__ directories eliminados${NC}"
((CLEANED++))

# 6. backups directory (con confirmaci√≥n)
echo -e "${YELLOW}6. Verificando directorio backups/...${NC}"
if [ -d "backups" ] && [ "$(ls -A backups)" ]; then
    echo "   Directorio backups/ contiene archivos. ¬øEliminar? (y/N)"
    read -r response
    if [[ "$response" =~ ^([yY][eE][sS]|[yY])$ ]]; then
        rm -rf backups/
        echo -e "${GREEN}‚úì backups/ eliminado${NC}"
        ((CLEANED++))
    fi
else
    echo -e "${GREEN}‚úì backups/ vac√≠o o no existe${NC}"
fi

# 7. Limpiar logs antiguos (opcional)
echo -e "${YELLOW}7. ¬øLimpiar logs antiguos? (y/N)${NC}"
read -r response
if [[ "$response" =~ ^([yY][eE][sS]|[yY])$ ]]; then
    find logs/ -type f -name "*.log" -mtime +7 -delete 2>/dev/null || true
    echo -e "${GREEN}‚úì Logs antiguos eliminados${NC}"
    ((CLEANED++))
fi

# 8. Verificar archivos en git que no deber√≠an estar
echo -e "${YELLOW}8. Verificando archivos en git que deber√≠an ser ignorados...${NC}"
if git rev-parse --git-dir > /dev/null 2>&1; then
    # Verificar uv.lock
    if git ls-files | grep -q "uv.lock"; then
        git rm --cached uv.lock 2>/dev/null || true
        echo -e "${YELLOW}   ! uv.lock removido de git (commit pendiente)${NC}"
    fi
    
    # Verificar docker-compose.override.yml
    if git ls-files | grep -q "docker-compose.override.yml"; then
        git rm --cached docker-compose.override.yml 2>/dev/null || true
        echo -e "${YELLOW}   ! docker-compose.override.yml removido de git (commit pendiente)${NC}"
    fi
    
    # Verificar build/
    if git ls-files | grep -q "^build/"; then
        git rm -r --cached build/ 2>/dev/null || true
        echo -e "${YELLOW}   ! build/ removido de git (commit pendiente)${NC}"
    fi
    
    # Verificar dist/
    if git ls-files | grep -q "^dist/"; then
        git rm -r --cached dist/ 2>/dev/null || true
        echo -e "${YELLOW}   ! dist/ removido de git (commit pendiente)${NC}"
    fi
fi

echo ""
echo -e "${GREEN}‚úÖ Limpieza completada!${NC}"
echo "   Acciones realizadas: $CLEANED"
echo ""
echo -e "${YELLOW}üìù Pr√≥ximos pasos:${NC}"
echo "   1. Revisar cambios: git status"
echo "   2. Si hay archivos removidos de git: git commit -m 'Clean up ignored files'"
echo "   3. Verificar .gitignore est√° actualizado"
```

---

## ‚úÖ SCRIPT DE LIMPIEZA DE VERSIONES ANTIGUAS

### Crear scripts/clean-old-versions.sh

```bash
#!/bin/bash
set -e

echo "üóÇÔ∏è  Limpiando versiones antiguas de modelos y reportes..."
echo ""

KEEP_VERSIONS=2  # Mantener las 2 versiones m√°s recientes

clean_versioned_dir() {
    local dir=$1
    local name=$(basename "$dir")
    
    if [ ! -d "$dir" ]; then
        return
    fi
    
    echo "Procesando: $name"
    
    # Contar versiones
    version_count=$(ls -1 "$dir" 2>/dev/null | wc -l)
    
    if [ "$version_count" -le "$KEEP_VERSIONS" ]; then
        echo "  ‚úì Solo $version_count versiones, manteniendo todas"
        return
    fi
    
    # Eliminar versiones antiguas (mantener las m√°s recientes)
    ls -1t "$dir" | tail -n +$((KEEP_VERSIONS + 1)) | while read -r version; do
        echo "  üóëÔ∏è  Eliminando versi√≥n antigua: $version"
        rm -rf "$dir/$version"
    done
    
    echo "  ‚úì Mantenidas $KEEP_VERSIONS versiones m√°s recientes"
}

# Limpiar modelos
if [ -d "data/06_models" ]; then
    echo "üì¶ Limpiando modelos..."
    for model_dir in data/06_models/*/; do
        clean_versioned_dir "$model_dir"
    done
fi

# Limpiar reportes
if [ -d "data/08_reporting" ]; then
    echo "üìä Limpiando reportes..."
    for report_dir in data/08_reporting/*/; do
        clean_versioned_dir "$report_dir"
    done
fi

echo ""
echo "‚úÖ Limpieza de versiones completada!"
echo ""
echo "Versiones actuales:"
du -sh data/06_models/*/ 2>/dev/null || true
du -sh data/08_reporting/*/ 2>/dev/null || true
```

---

## üîç VERIFICACI√ìN POST-LIMPIEZA

### Checklist de Verificaci√≥n

```bash
# 1. Verificar no hay archivos basura
echo "Verificando notebooks temporales..."
ls -la notebooks/Untitled* 2>/dev/null && echo "‚ùå A√öN EXISTEN" || echo "‚úÖ OK"

echo "Verificando airflow_dags duplicado..."
[ -d "airflow_dags" ] && echo "‚ùå A√öN EXISTE" || echo "‚úÖ OK"

echo "Verificando build artifacts..."
[ -d "build" ] && echo "‚ùå build/ A√öN EXISTE" || echo "‚úÖ OK"
[ -d "dist" ] && echo "‚ùå dist/ A√öN EXISTE" || echo "‚úÖ OK"

echo "Verificando info.log..."
[ -f "info.log" ] && echo "‚ùå A√öN EXISTE" || echo "‚úÖ OK"

# 2. Verificar .gitignore actualizado
echo ""
echo "Verificando .gitignore..."
grep -q "build/" .gitignore && echo "‚úÖ build/ en .gitignore" || echo "‚ùå FALTA build/"
grep -q "dist/" .gitignore && echo "‚úÖ dist/ en .gitignore" || echo "‚ùå FALTA dist/"
grep -q "*.log" .gitignore && echo "‚úÖ *.log en .gitignore" || echo "‚ùå FALTA *.log"

# 3. Verificar git status limpio
echo ""
echo "Git status:"
git status --short

# 4. Verificar tama√±o del repo
echo ""
echo "Tama√±o del directorio:"
du -sh .
```

---

## üìã ACTUALIZAR .gitignore

### Asegurar que .gitignore tiene:

```gitignore
# Build artifacts
build/
dist/
*.egg-info/
*.egg

# Logs
*.log
logs/

# Temporary files
*.tmp
*.bak
*~

# Notebooks
.ipynb_checkpoints
notebooks/Untitled*.ipynb

# Python
__pycache__/
*.py[cod]
*$py.class

# Data
data/01_raw/
data/02_intermediate/
data/03_primary/
data/04_feature/
data/05_model_input/
data/06_models/
data/07_model_output/
data/08_reporting/

# Sessions
sessions/

# Backups
backups/

# Environment
.env

# UV
uv.lock

# Docker
docker-compose.override.yml
```

---

## üéØ ORDEN DE EJECUCI√ìN

### Paso a Paso:

```bash
# 1. Hacer backup del estado actual (por si acaso)
git status > pre-cleanup-status.txt
git diff > pre-cleanup-diff.txt

# 2. Ejecutar limpieza principal
chmod +x scripts/clean-repo.sh
./scripts/clean-repo.sh

# 3. Limpiar versiones antiguas (opcional)
chmod +x scripts/clean-old-versions.sh
./scripts/clean-old-versions.sh

# 4. Verificar estado
git status

# 5. Revisar cambios
git diff

# 6. Si todo OK, commit
git add .gitignore
git commit -m "chore: Clean up repository - remove build artifacts, temp files, and duplicates"

# 7. Si hay archivos removidos de git
git status | grep deleted && git commit -m "chore: Remove ignored files from git tracking"
```

---

## ‚ö†Ô∏è PRECAUCIONES

### Antes de Ejecutar Limpieza:

1. **Hacer backup** o trabajar en una rama
2. **Revisar backups/** antes de eliminar
3. **Verificar airflow_dags/** es id√©ntico a dags/
4. **Considerar** si necesitas versiones antiguas de modelos
5. **Probar** que el proyecto funciona despu√©s de limpieza

### Recuperaci√≥n de Emergencia:

Si algo sale mal:
```bash
# Restaurar desde git
git checkout .
git clean -fd

# O usar backup
git stash
```

---

## üìä RESULTADOS ESPERADOS

### Despu√©s de la limpieza:

- ‚úÖ Sin notebooks temporales
- ‚úÖ Sin directorios duplicados
- ‚úÖ Sin build artifacts en git
- ‚úÖ Sin logs commitados
- ‚úÖ Solo 1-2 versiones de modelos para ejemplo
- ‚úÖ .gitignore actualizado
- ‚úÖ Repositorio m√°s limpio y comprensible
- ‚úÖ Menos confusi√≥n para estudiantes

### Beneficios:

1. **Claridad**: Estructura m√°s clara y predecible
2. **Tama√±o**: Repositorio m√°s liviano
3. **Performance**: Clone y pull m√°s r√°pidos
4. **Educaci√≥n**: Sin archivos que distraigan o confundan
5. **Mantenibilidad**: M√°s f√°cil de mantener

---

## üìö RESUMEN DE ARCHIVOS BASURA

| Archivo/Directorio | Acci√≥n | Prioridad | Raz√≥n |
|-------------------|--------|-----------|-------|
| notebooks/Untitled*.ipynb | ‚ùå Eliminar | üî¥ Cr√≠tica | Temporales sin valor |
| airflow_dags/ | ‚ùå Eliminar | üî¥ Cr√≠tica | Duplicado de dags/ |
| build/ | ‚ùå Eliminar | üî¥ Cr√≠tica | Build artifacts |
| dist/ | ‚ùå Eliminar | üî¥ Cr√≠tica | Distribution artifacts |
| src/*.egg-info/ | ‚ùå Eliminar | üî¥ Cr√≠tica | Installation artifacts |
| info.log | ‚ùå Eliminar | üî¥ Cr√≠tica | Log suelto |
| __pycache__/ | ‚ùå Limpiar | üü° Media | Archivos temporales |
| backups/ | ‚ö†Ô∏è Revisar | üü° Media | Puede tener datos √∫tiles |
| logs/* (contenido) | ‚ö†Ô∏è Limpiar viejos | üü¢ Baja | Mantener estructura |
| data/06_models/* (versiones viejas) | ‚ö†Ô∏è Limpiar | üü¢ Baja | Mantener 1-2 recientes |
| data/08_reporting/* (versiones viejas) | ‚ö†Ô∏è Limpiar | üü¢ Baja | Mantener 1-2 recientes |

---

**√öltima actualizaci√≥n**: 2025-10-09
**Versi√≥n**: 1.0
**Estado**: Listo para ejecutar

